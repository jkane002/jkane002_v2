{% extends 'base/index.html' %}
{% load static %}
{% block content %}

<section>
    <div class="row">
        <div class="col-lg-5 ml-auto text-center">
            <div class="checkout-container pb-1">
                <button class="btn btn-primary m-1" id="buy_now_btn">Submit Payment</button>
            </div>
        </div>
        <div class="col-lg-5 m-auto p-auto">
            <h3>Tutoring Services</h3>
            <ul>
                <li>One-on-one Python / Computer Science tutoring</li>
                <li>Specialized lessons for each student</li>
                <li>Learn at your own pace</li>
                <li>Meet once a week at a specified date and time</li>
            </ul>
            <h3>Means of Communication</h3>
            <ul>
                <li>Lessons conducted via Skype (preferred), Google Hangout, or Zoom</li>
                <li>General communication via email</li>
                <li>Summary of each lesson is given after each session</li>
                <li>Initial email outlining curriculum</li>
            </ul>
            <h3>Payment</h3>
            <ul>
                <li>Pay Rate - $35 / hourly, 1 hour per week</li>
                <li>10 weeks, 15 weeks, or 20 weeks of tutoring</li>
                <li>Payment transferred in full amount (preferred), weekly, or biweekly</li>
                <li>Inquire for custom hours / course length</li>
            </ul>
        </div>
    </div>
</section>
<!-- Stripe API -->
<script src="https://js.stripe.com/v3/"></script>
<script>
    // Locate buy button
    const buy_now_btn = document.querySelector('#buy_now_btn')

    buy_now_btn.addEventListener('click', event => {
        // Call your backend to create the Checkout Session
        fetch('/tutor/charge/', {
            method: 'POST',
        })
            .then(function (response) {
                return response.json();
            })
            .then(function (session) {
                var stripe = Stripe(session.STRIPE_TEST_PK);
                return stripe.redirectToCheckout({ sessionId: session.session_id });
            })
            .then(function (result) {
                // If `redirectToCheckout` fails due to a browser or network
                // error, you should display the localized error message to your
                // customer using `error.message`.

                // TODO: Alert on screen 
                if (result.error) {
                    alert(result.error.message);
                }
            });
    })
</script>
{% endblock content %}